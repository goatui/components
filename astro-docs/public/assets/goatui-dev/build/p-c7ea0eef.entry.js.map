{"version":3,"names":["MILLISECONDS_IN_HOUR","addHours","dirtyDate","dirtyAmount","requiredArgs","arguments","amount","toInteger","addMilliseconds","startOfWeek","options","_ref","_ref2","_ref3","_options$weekStartsOn","_options$locale","_options$locale$optio","_defaultOptions$local","_defaultOptions$local2","defaultOptions","getDefaultOptions","weekStartsOn","locale","RangeError","date","toDate","day","getDay","diff","setDate","getDate","setHours","MILLISECONDS_IN_DAY","differenceInCalendarDays","dirtyDateLeft","dirtyDateRight","startOfDayLeft","startOfDay","startOfDayRight","timestampLeft","getTime","getTimezoneOffsetInMilliseconds","timestampRight","Math","round","compareLocalAsc","dateLeft","dateRight","getFullYear","getMonth","getHours","getMinutes","getSeconds","getMilliseconds","differenceInDays","sign","difference","abs","isLastDayNotFull","Number","result","differenceInMilliseconds","endOfDay","endOfMonth","month","setFullYear","startOfMonth","endOfWeek","calculateMonthRange","startDate","endDate","totalDays","calculateWeekRange","calculateDateRange","view","contextDate","days","dateRange","addDays","ColumnEvent","CalendarEvent","constructor","event","super","start","end","title","data","this","width","ColumnEventManager","_ColumnEventManager_events","set","addEvents","events","forEach","__classPrivateFieldGet","push","process","columns","sort","a","b","length","oldLength","Error","column","i","filter","e","find","ce","gid","j","colEvent","isOverlapping","columnViewCss","CalendarColumnView","singleDayEvents","multiDayEvents","componentWillRender","_CalendarColumnView_instances","_CalendarColumnView_forEachDayInDateRange","call","manager","BaseEvent","_CalendarColumnView_getDateOnly","componentDidLoad","viewBodyHeight","elm","shadowRoot","querySelector","scrollHeight","scroll","top","getTimePercent","currentTime","renderHeader","cls","h","class","join","onClick","goatColumnViewDateClick","emit","format","renderMultiDayBackground","Date","renderScale","rows","startTime","row","renderEvents","isEqual","eventDay","columnsLength","map","nodes","columnIndex","node","eventClickable","goatColumnViewEventClick","style","height","left","renderMultiDayEvents","getDatePercent","currentDay","percent","forDay","valueOf","renderCurrentTime","render","callback","MonthEventManager","_MonthEventManager_events","monthViewCss","CalendarMonthView","weekDayEvents","eventPadding","index","goatMonthViewEventClick"],"sources":["node_modules/date-fns/esm/addHours/index.js","node_modules/date-fns/esm/startOfWeek/index.js","node_modules/date-fns/esm/differenceInCalendarDays/index.js","node_modules/date-fns/esm/differenceInDays/index.js","node_modules/date-fns/esm/differenceInMilliseconds/index.js","node_modules/date-fns/esm/endOfDay/index.js","node_modules/date-fns/esm/endOfMonth/index.js","node_modules/date-fns/esm/startOfMonth/index.js","node_modules/date-fns/esm/endOfWeek/index.js","src/components/calendar/calendar/utils.tsx","src/components/calendar/calendar/column-view/utils.tsx","src/components/calendar/calendar/column-view/ColumnEventManager.tsx","src/components/calendar/calendar/column-view/column-view.scss?tag=goat-calendar-column-view&encapsulation=shadow","src/components/calendar/calendar/column-view/column-view.tsx","src/components/calendar/calendar/month-view/MonthEventManager.tsx","src/components/calendar/calendar/month-view/month-view.scss?tag=goat-calendar-month-view&encapsulation=shadow","src/components/calendar/calendar/month-view/month-view.tsx"],"sourcesContent":["import toInteger from \"../_lib/toInteger/index.js\";\nimport addMilliseconds from \"../addMilliseconds/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\nvar MILLISECONDS_IN_HOUR = 3600000;\n\n/**\n * @name addHours\n * @category Hour Helpers\n * @summary Add the specified number of hours to the given date.\n *\n * @description\n * Add the specified number of hours to the given date.\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of hours to be added. Positive decimals will be rounded using `Math.floor`, decimals less than zero will be rounded using `Math.ceil`.\n * @returns {Date} the new date with the hours added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 2 hours to 10 July 2014 23:00:00:\n * const result = addHours(new Date(2014, 6, 10, 23, 0), 2)\n * //=> Fri Jul 11 2014 01:00:00\n */\nexport default function addHours(dirtyDate, dirtyAmount) {\n  requiredArgs(2, arguments);\n  var amount = toInteger(dirtyAmount);\n  return addMilliseconds(dirtyDate, amount * MILLISECONDS_IN_HOUR);\n}","import toDate from \"../toDate/index.js\";\nimport toInteger from \"../_lib/toInteger/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\nimport { getDefaultOptions } from \"../_lib/defaultOptions/index.js\";\n/**\n * @name startOfWeek\n * @category Week Helpers\n * @summary Return the start of a week for the given date.\n *\n * @description\n * Return the start of a week for the given date.\n * The result will be in the local timezone.\n *\n * @param {Date|Number} date - the original date\n * @param {Object} [options] - an object with options.\n * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}\n * @param {0|1|2|3|4|5|6} [options.weekStartsOn=0] - the index of the first day of the week (0 - Sunday)\n * @returns {Date} the start of a week\n * @throws {TypeError} 1 argument required\n * @throws {RangeError} `options.weekStartsOn` must be between 0 and 6\n *\n * @example\n * // The start of a week for 2 September 2014 11:55:00:\n * const result = startOfWeek(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Sun Aug 31 2014 00:00:00\n *\n * @example\n * // If the week starts on Monday, the start of the week for 2 September 2014 11:55:00:\n * const result = startOfWeek(new Date(2014, 8, 2, 11, 55, 0), { weekStartsOn: 1 })\n * //=> Mon Sep 01 2014 00:00:00\n */\nexport default function startOfWeek(dirtyDate, options) {\n  var _ref, _ref2, _ref3, _options$weekStartsOn, _options$locale, _options$locale$optio, _defaultOptions$local, _defaultOptions$local2;\n  requiredArgs(1, arguments);\n  var defaultOptions = getDefaultOptions();\n  var weekStartsOn = toInteger((_ref = (_ref2 = (_ref3 = (_options$weekStartsOn = options === null || options === void 0 ? void 0 : options.weekStartsOn) !== null && _options$weekStartsOn !== void 0 ? _options$weekStartsOn : options === null || options === void 0 ? void 0 : (_options$locale = options.locale) === null || _options$locale === void 0 ? void 0 : (_options$locale$optio = _options$locale.options) === null || _options$locale$optio === void 0 ? void 0 : _options$locale$optio.weekStartsOn) !== null && _ref3 !== void 0 ? _ref3 : defaultOptions.weekStartsOn) !== null && _ref2 !== void 0 ? _ref2 : (_defaultOptions$local = defaultOptions.locale) === null || _defaultOptions$local === void 0 ? void 0 : (_defaultOptions$local2 = _defaultOptions$local.options) === null || _defaultOptions$local2 === void 0 ? void 0 : _defaultOptions$local2.weekStartsOn) !== null && _ref !== void 0 ? _ref : 0);\n\n  // Test if weekStartsOn is between 0 and 6 _and_ is not NaN\n  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {\n    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');\n  }\n  var date = toDate(dirtyDate);\n  var day = date.getDay();\n  var diff = (day < weekStartsOn ? 7 : 0) + day - weekStartsOn;\n  date.setDate(date.getDate() - diff);\n  date.setHours(0, 0, 0, 0);\n  return date;\n}","import getTimezoneOffsetInMilliseconds from \"../_lib/getTimezoneOffsetInMilliseconds/index.js\";\nimport startOfDay from \"../startOfDay/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\nvar MILLISECONDS_IN_DAY = 86400000;\n\n/**\n * @name differenceInCalendarDays\n * @category Day Helpers\n * @summary Get the number of calendar days between the given dates.\n *\n * @description\n * Get the number of calendar days between the given dates. This means that the times are removed\n * from the dates and then the difference in days is calculated.\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of calendar days\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many calendar days are between\n * // 2 July 2011 23:00:00 and 2 July 2012 00:00:00?\n * const result = differenceInCalendarDays(\n *   new Date(2012, 6, 2, 0, 0),\n *   new Date(2011, 6, 2, 23, 0)\n * )\n * //=> 366\n * // How many calendar days are between\n * // 2 July 2011 23:59:00 and 3 July 2011 00:01:00?\n * const result = differenceInCalendarDays(\n *   new Date(2011, 6, 3, 0, 1),\n *   new Date(2011, 6, 2, 23, 59)\n * )\n * //=> 1\n */\nexport default function differenceInCalendarDays(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var startOfDayLeft = startOfDay(dirtyDateLeft);\n  var startOfDayRight = startOfDay(dirtyDateRight);\n  var timestampLeft = startOfDayLeft.getTime() - getTimezoneOffsetInMilliseconds(startOfDayLeft);\n  var timestampRight = startOfDayRight.getTime() - getTimezoneOffsetInMilliseconds(startOfDayRight);\n\n  // Round the number of days to the nearest integer\n  // because the number of milliseconds in a day is not constant\n  // (e.g. it's different in the day of the daylight saving time clock shift)\n  return Math.round((timestampLeft - timestampRight) / MILLISECONDS_IN_DAY);\n}","import toDate from \"../toDate/index.js\";\nimport differenceInCalendarDays from \"../differenceInCalendarDays/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\"; // Like `compareAsc` but uses local time not UTC, which is needed\n// for accurate equality comparisons of UTC timestamps that end up\n// having the same representation in local time, e.g. one hour before\n// DST ends vs. the instant that DST ends.\nfunction compareLocalAsc(dateLeft, dateRight) {\n  var diff = dateLeft.getFullYear() - dateRight.getFullYear() || dateLeft.getMonth() - dateRight.getMonth() || dateLeft.getDate() - dateRight.getDate() || dateLeft.getHours() - dateRight.getHours() || dateLeft.getMinutes() - dateRight.getMinutes() || dateLeft.getSeconds() - dateRight.getSeconds() || dateLeft.getMilliseconds() - dateRight.getMilliseconds();\n  if (diff < 0) {\n    return -1;\n  } else if (diff > 0) {\n    return 1;\n    // Return 0 if diff is 0; return NaN if diff is NaN\n  } else {\n    return diff;\n  }\n}\n\n/**\n * @name differenceInDays\n * @category Day Helpers\n * @summary Get the number of full days between the given dates.\n *\n * @description\n * Get the number of full day periods between two dates. Fractional days are\n * truncated towards zero.\n *\n * One \"full day\" is the distance between a local time in one day to the same\n * local time on the next or previous day. A full day can sometimes be less than\n * or more than 24 hours if a daylight savings change happens between two dates.\n *\n * To ignore DST and only measure exact 24-hour periods, use this instead:\n * `Math.floor(differenceInHours(dateLeft, dateRight)/24)|0`.\n *\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of full days according to the local timezone\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many full days are between\n * // 2 July 2011 23:00:00 and 2 July 2012 00:00:00?\n * const result = differenceInDays(\n *   new Date(2012, 6, 2, 0, 0),\n *   new Date(2011, 6, 2, 23, 0)\n * )\n * //=> 365\n * // How many full days are between\n * // 2 July 2011 23:59:00 and 3 July 2011 00:01:00?\n * const result = differenceInDays(\n *   new Date(2011, 6, 3, 0, 1),\n *   new Date(2011, 6, 2, 23, 59)\n * )\n * //=> 0\n * // How many full days are between\n * // 1 March 2020 0:00 and 1 June 2020 0:00 ?\n * // Note: because local time is used, the\n * // result will always be 92 days, even in\n * // time zones where DST starts and the\n * // period has only 92*24-1 hours.\n * const result = differenceInDays(\n *   new Date(2020, 5, 1),\n *   new Date(2020, 2, 1)\n * )\n//=> 92\n */\nexport default function differenceInDays(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var sign = compareLocalAsc(dateLeft, dateRight);\n  var difference = Math.abs(differenceInCalendarDays(dateLeft, dateRight));\n  dateLeft.setDate(dateLeft.getDate() - sign * difference);\n\n  // Math.abs(diff in full days - diff in calendar days) === 1 if last calendar day is not full\n  // If so, result must be decreased by 1 in absolute value\n  var isLastDayNotFull = Number(compareLocalAsc(dateLeft, dateRight) === -sign);\n  var result = sign * (difference - isLastDayNotFull);\n  // Prevent negative zero\n  return result === 0 ? 0 : result;\n}","import toDate from \"../toDate/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name differenceInMilliseconds\n * @category Millisecond Helpers\n * @summary Get the number of milliseconds between the given dates.\n *\n * @description\n * Get the number of milliseconds between the given dates.\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of milliseconds\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many milliseconds are between\n * // 2 July 2014 12:30:20.600 and 2 July 2014 12:30:21.700?\n * const result = differenceInMilliseconds(\n *   new Date(2014, 6, 2, 12, 30, 21, 700),\n *   new Date(2014, 6, 2, 12, 30, 20, 600)\n * )\n * //=> 1100\n */\nexport default function differenceInMilliseconds(dateLeft, dateRight) {\n  requiredArgs(2, arguments);\n  return toDate(dateLeft).getTime() - toDate(dateRight).getTime();\n}","import toDate from \"../toDate/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name endOfDay\n * @category Day Helpers\n * @summary Return the end of a day for the given date.\n *\n * @description\n * Return the end of a day for the given date.\n * The result will be in the local timezone.\n *\n * @param {Date|Number} date - the original date\n * @returns {Date} the end of a day\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // The end of a day for 2 September 2014 11:55:00:\n * const result = endOfDay(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 02 2014 23:59:59.999\n */\nexport default function endOfDay(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  date.setHours(23, 59, 59, 999);\n  return date;\n}","import toDate from \"../toDate/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name endOfMonth\n * @category Month Helpers\n * @summary Return the end of a month for the given date.\n *\n * @description\n * Return the end of a month for the given date.\n * The result will be in the local timezone.\n *\n * @param {Date|Number} date - the original date\n * @returns {Date} the end of a month\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // The end of a month for 2 September 2014 11:55:00:\n * const result = endOfMonth(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 30 2014 23:59:59.999\n */\nexport default function endOfMonth(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  var month = date.getMonth();\n  date.setFullYear(date.getFullYear(), month + 1, 0);\n  date.setHours(23, 59, 59, 999);\n  return date;\n}","import toDate from \"../toDate/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name startOfMonth\n * @category Month Helpers\n * @summary Return the start of a month for the given date.\n *\n * @description\n * Return the start of a month for the given date.\n * The result will be in the local timezone.\n *\n * @param {Date|Number} date - the original date\n * @returns {Date} the start of a month\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // The start of a month for 2 September 2014 11:55:00:\n * const result = startOfMonth(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Mon Sep 01 2014 00:00:00\n */\nexport default function startOfMonth(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  date.setDate(1);\n  date.setHours(0, 0, 0, 0);\n  return date;\n}","import { getDefaultOptions } from \"../_lib/defaultOptions/index.js\";\nimport toDate from \"../toDate/index.js\";\nimport toInteger from \"../_lib/toInteger/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name endOfWeek\n * @category Week Helpers\n * @summary Return the end of a week for the given date.\n *\n * @description\n * Return the end of a week for the given date.\n * The result will be in the local timezone.\n *\n * @param {Date|Number} date - the original date\n * @param {Object} [options] - an object with options.\n * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}\n * @param {0|1|2|3|4|5|6} [options.weekStartsOn=0] - the index of the first day of the week (0 - Sunday)\n * @returns {Date} the end of a week\n * @throws {TypeError} 1 argument required\n * @throws {RangeError} `options.weekStartsOn` must be between 0 and 6\n *\n * @example\n * // The end of a week for 2 September 2014 11:55:00:\n * const result = endOfWeek(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Sat Sep 06 2014 23:59:59.999\n *\n * @example\n * // If the week starts on Monday, the end of the week for 2 September 2014 11:55:00:\n * const result = endOfWeek(new Date(2014, 8, 2, 11, 55, 0), { weekStartsOn: 1 })\n * //=> Sun Sep 07 2014 23:59:59.999\n */\nexport default function endOfWeek(dirtyDate, options) {\n  var _ref, _ref2, _ref3, _options$weekStartsOn, _options$locale, _options$locale$optio, _defaultOptions$local, _defaultOptions$local2;\n  requiredArgs(1, arguments);\n  var defaultOptions = getDefaultOptions();\n  var weekStartsOn = toInteger((_ref = (_ref2 = (_ref3 = (_options$weekStartsOn = options === null || options === void 0 ? void 0 : options.weekStartsOn) !== null && _options$weekStartsOn !== void 0 ? _options$weekStartsOn : options === null || options === void 0 ? void 0 : (_options$locale = options.locale) === null || _options$locale === void 0 ? void 0 : (_options$locale$optio = _options$locale.options) === null || _options$locale$optio === void 0 ? void 0 : _options$locale$optio.weekStartsOn) !== null && _ref3 !== void 0 ? _ref3 : defaultOptions.weekStartsOn) !== null && _ref2 !== void 0 ? _ref2 : (_defaultOptions$local = defaultOptions.locale) === null || _defaultOptions$local === void 0 ? void 0 : (_defaultOptions$local2 = _defaultOptions$local.options) === null || _defaultOptions$local2 === void 0 ? void 0 : _defaultOptions$local2.weekStartsOn) !== null && _ref !== void 0 ? _ref : 0);\n\n  // Test if weekStartsOn is between 0 and 6 _and_ is not NaN\n  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {\n    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');\n  }\n  var date = toDate(dirtyDate);\n  var day = date.getDay();\n  var diff = (day < weekStartsOn ? -7 : 0) + 6 - (day - weekStartsOn);\n  date.setDate(date.getDate() + diff);\n  date.setHours(23, 59, 59, 999);\n  return date;\n}","import { endOfMonth, endOfWeek, startOfMonth, startOfWeek } from 'date-fns/esm';\n\n\n/**\n * Calculates start and end dates of month in a calendar.\n * @param date Context date for which range need to calculated.\n * @param weekStartsOn A numeric value. The index of the first day of the week (0 - Sunday)\n */\nexport function calculateMonthRange(date, weekStartsOn: 0 | 1 | 2 | 3 | 4 | 5 | 6 = 1) {\n  const startDate = startOfWeek(startOfMonth(date), { weekStartsOn });\n  const endDate = endOfWeek(endOfMonth(date), { weekStartsOn });\n  return {\n    startDate,\n    endDate,\n    totalDays: 42,\n  };\n}\n\n/*\n *\n */\nexport function calculateWeekRange(date, weekStartsOn: 0 | 1 | 2 | 3 | 4 | 5 | 6 = 1) {\n  const startDate = startOfWeek(date, { weekStartsOn });\n  const endDate = endOfWeek(date, { weekStartsOn });\n  return {\n    startDate,\n    endDate,\n    totalDays: 7,\n  };\n}\n\n\n\n","import { calculateWeekRange } from '../utils';\nimport { addDays, endOfDay, startOfDay } from 'date-fns';\n\nexport function calculateDateRange(view, contextDate, days) {\n  if (view === 'week') {\n    return calculateWeekRange(contextDate, 1 /* monday */);\n  } else {\n    const dateRange: any = {};\n    dateRange.startDate = startOfDay(contextDate);\n    dateRange.endDate = endOfDay(addDays(contextDate, days - 1));\n    dateRange.totalDays = days;\n    return dateRange;\n  }\n}\n","import { CalendarEvent } from '../CalendarEvent';\nimport { differenceInMilliseconds } from 'date-fns';\n\nexport class ColumnEvent extends CalendarEvent {\n  width: number = 1;\n\n  constructor(event: CalendarEvent) {\n    super(event.start, event.end, event.title, event.data);\n  }\n}\n\nexport default class ColumnEventManager {\n\n  #events: ColumnEvent[] = [];\n\n  columns: ColumnEvent[][];\n\n  constructor() {\n\n  }\n\n  addEvents(events: CalendarEvent[]) {\n    events.forEach((event) => {\n      this.#events.push(new ColumnEvent(event));\n    });\n  }\n\n  process() {\n    this.columns = [];\n    let events = this.#events.sort((a, b) => {\n      return differenceInMilliseconds(a.start, b.start) || b.length() - a.length();\n    });\n\n    let oldLength = null;\n    /* Bucketing */\n    while (events.length) {\n      if (oldLength == events.length)\n        throw new Error('Events not processed in previous run, breaking infinite loop');\n      oldLength = events.length;\n\n      const column = [];\n      for (let i = 0; i < events.length; i++) {\n        if (i == 0)\n          column.push(events[i]);\n        else if (differenceInMilliseconds(events[i].start, column[column.length - 1].end) >= 0) {\n          column.push(events[i]);\n        }\n      }\n      this.columns.push(column);\n      events = events.filter((e) => {\n        return !column.find((ce) => {\n          return ce.gid == e.gid;\n        });\n      });\n    }\n\n    for (let i = 0; i < this.columns.length - 1; i++) {\n\n      this.columns[i].forEach((event) => {\n        for (let j = i + 1; j < this.columns.length; j++) {\n          if (this.columns[j].find((colEvent) => {\n            return event.isOverlapping(colEvent);\n          })) {\n            break;\n          }\n          event.width++;\n        }\n      });\n\n    }\n  }\n}\n","@import \"../../../../globalStyles/commons\";\r\n\r\n:host {\r\n  display: block;\r\n  height: 100%;\r\n  --calendar-border-color: #{v(--border-strong-01)};\r\n  --scale-size: 3rem;\r\n  --scale-color: #{v(--text-placeholder)}\r\n}\r\n\r\n.scale {\r\n  width: var(--scale-size);\r\n}\r\n\r\n.calendar-column-view {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n\r\n  .view-header {\r\n    border-top: 1px solid v(--border-strong-01);\r\n    display: flex;\r\n\r\n    .scale {\r\n      border-right: 1px solid v(--scale-color);\r\n    }\r\n\r\n    .columns {\r\n      display: flex;\r\n      flex: 1;\r\n\r\n      .column {\r\n        flex: 1;\r\n        border-right: 1px solid v(--scale-color);\r\n\r\n\r\n        .column-content {\r\n          display: flex;\r\n          border-top: .5rem solid transparent;\r\n          align-items: center;\r\n          padding: .5rem;\r\n          gap: .5rem;\r\n        }\r\n\r\n        &.today {\r\n          .column-content {\r\n            border-top-color: v(--color-primary);\r\n\r\n            .date {\r\n              color: v(--color-primary);\r\n            }\r\n          }\r\n        }\r\n\r\n        .date {\r\n          font-size: 2rem;\r\n          cursor: pointer;\r\n          border-radius: 100%;\r\n          padding: 0.5rem;\r\n\r\n          &:hover {\r\n            background: v(--color-primary-30);\r\n          }\r\n        }\r\n\r\n        .day {\r\n          font-size: 1rem;\r\n        }\r\n      }\r\n    }\r\n\r\n    .scrollbar-placeholder {\r\n      width: var(--scrollbar-width);\r\n    }\r\n  }\r\n\r\n  .multi-day-section-wrapper {\r\n    border-bottom: 1px solid v(--scale-color);\r\n\r\n    .multi-day-section-scroll {\r\n      overflow-y: scroll;\r\n      max-height: 6rem;\r\n\r\n      .multi-day-section {\r\n        position: relative;\r\n\r\n        .multi-day-background {\r\n          display: flex;\r\n          height: 100%;\r\n          position: absolute;\r\n          width: 100%;\r\n\r\n          .scale {\r\n            border-right: 1px solid v(--scale-color);\r\n          }\r\n\r\n          .columns {\r\n            display: flex;\r\n            flex: 1;\r\n\r\n            .column {\r\n              flex: 1;\r\n              border-right: 1px solid v(--scale-color);\r\n            }\r\n          }\r\n        }\r\n\r\n        .multi-events {\r\n          padding: 0 0 0 var(--scale-size);\r\n\r\n\r\n          .row {\r\n            height: 1.8rem;\r\n            box-sizing: content-box;\r\n            position: relative;\r\n            padding-bottom: .5rem;\r\n            &:last-child {\r\n              padding-bottom: 0;\r\n            }\r\n          }\r\n\r\n          .row-spacer {\r\n            height: 1rem;\r\n          }\r\n\r\n          .event {\r\n            background: v(--color-primary-20);\r\n            border-left: .35rem solid v(--color-primary);\r\n            border-radius: 3px;\r\n            position: absolute;\r\n            height: 1.8rem;\r\n            text-overflow: ellipsis;\r\n            overflow: hidden;\r\n\r\n            .event-title {\r\n              padding: 0.25rem;\r\n              @include font-style(body-01);\r\n            }\r\n\r\n            &.clickable {\r\n              cursor: pointer;\r\n\r\n              &:hover {\r\n                background: v(--color-primary-30);\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  .view-body {\r\n    height: 100%;\r\n    border-bottom: 1px solid v(--calendar-border-color);\r\n    overflow-y: scroll;\r\n\r\n    .view-body-scroll {\r\n      display: flex;\r\n      position: relative;\r\n\r\n      .scale {\r\n        border-right: 1px solid v(--scale-color);\r\n\r\n        .row {\r\n          width: 0;\r\n          position: relative;\r\n          height: 2rem;\r\n          border-bottom: 1px dashed v(--scale-color);\r\n\r\n          &.hour {\r\n            border-bottom: 1px solid v(--scale-color);\r\n            width: 50%;\r\n            margin-inline-start: 50%;\r\n          }\r\n\r\n          &:last-child {\r\n            border-bottom: 0;\r\n          }\r\n\r\n          .time {\r\n            position: absolute;\r\n            top: -.5rem;\r\n            font-size: .75rem;\r\n          }\r\n        }\r\n      }\r\n\r\n      .drawing-area {\r\n        flex: 1;\r\n\r\n        .events-container {\r\n          position: absolute;\r\n          top: 0;\r\n          left: var(--scale-size);\r\n          width: calc(100% - var(--scale-size));\r\n          height: 100%;\r\n          display: flex;\r\n\r\n          .column {\r\n            flex: 1;\r\n            padding: 0 1rem 0 1px;\r\n\r\n            .column-content {\r\n              position: relative;\r\n              height: 100%;\r\n            }\r\n\r\n            .event {\r\n              background: v(--color-primary-20);\r\n              border-left: .35rem solid v(--color-primary);\r\n              border-radius: 3px;\r\n              position: absolute;\r\n\r\n              .event-title {\r\n                padding: 0.25rem;\r\n              }\r\n\r\n              &.clickable {\r\n                cursor: pointer;\r\n\r\n                &:hover {\r\n                  background: v(--color-primary-30);\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      .current-time-line {\r\n        position: absolute;\r\n        z-index: 100;\r\n        pointer-events: none;\r\n        width: calc(100% - var(--scale-size));\r\n        margin-inline-start: var(--scale-size);\r\n\r\n        .time {\r\n          position: absolute;\r\n          font-size: .5rem;\r\n          font-weight: 600;\r\n          color: v(--color-primary);\r\n          top: -6px;\r\n          left: -3rem;\r\n          background: v(--color-primary-10);\r\n          padding: 2px;\r\n          border-radius: 3px;\r\n        }\r\n\r\n        .dash-line {\r\n          position: absolute;\r\n          left: 0;\r\n          border-bottom: 1px dashed v(--color-primary);\r\n        }\r\n\r\n        .dot {\r\n          border-radius: 100%;\r\n          width: 0.5rem;\r\n          height: 0.5rem;\r\n          background: v(--color-primary);\r\n          display: block;\r\n          position: absolute;\r\n          top: -0.25rem;\r\n        }\r\n\r\n        .line {\r\n          border-bottom: 2px solid v(--color-primary);\r\n          position: absolute;\r\n          top: -1px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { Component, ComponentInterface, Element, Event, EventEmitter, h, Prop } from '@stencil/core';\nimport { addDays, addHours, differenceInDays, endOfDay, format, isEqual, startOfDay } from 'date-fns';\nimport { calculateDateRange } from './utils';\nimport ColumnEventManager from './ColumnEventManager';\nimport { BaseEvent } from '../event-management/BaseEvent';\n\n@Component({\n  tag: 'goat-calendar-column-view',\n  styleUrl: 'column-view.scss',\n  shadow: true,\n})\nexport class CalendarColumnView implements ComponentInterface {\n  @Element() elm!: HTMLElement;\n\n  @Prop() events: any[] = [];\n\n  @Prop() view = 'week';\n\n  @Prop() days = 7;\n\n  @Prop() eventClickable: boolean = true;\n\n  @Prop() currentTime: Date;\n\n  @Prop() contextDate: Date;\n\n  dateRange: any;\n\n  singleDayEvents: any = {};\n  multiDayEvents: any = [];\n\n  @Event({ eventName: 'goat:column-view-date-click' }) goatColumnViewDateClick: EventEmitter;\n\n  @Event({ eventName: 'goat:column-view-event-click' }) goatColumnViewEventClick: EventEmitter;\n\n  async componentWillRender() {\n    this.dateRange = calculateDateRange(this.view, this.contextDate, this.days);\n    this.singleDayEvents = {};\n    this.#forEachDayInDateRange(i => {\n      const manager = new ColumnEventManager();\n      manager.addEvents(\n        this.events.filter(event => {\n          return event.isOverlapping(new BaseEvent(startOfDay(i), endOfDay(i))) && event.length() < 86400000;\n        }),\n      );\n      manager.process();\n      this.singleDayEvents[this.#getDateOnly(i)] = manager.columns;\n    });\n    const manager = new ColumnEventManager();\n    manager.addEvents(this.events.filter(event => {\n      return event.isOverlapping(new BaseEvent(this.dateRange.startDate, this.dateRange.endDate)) && event.length() >= 86400000\n    }));\n    manager.process();\n    this.multiDayEvents = manager.columns;\n  }\n\n  #forEachDayInDateRange(callback) {\n    for (let i = new Date(this.dateRange.startDate); differenceInDays(startOfDay(this.dateRange.endDate), i) >= 0; i = addDays(i, 1)) {\n      callback(i);\n    }\n  }\n\n  #getDateOnly(date) {\n    return format(date, 'dd-MM-yyyy');\n  }\n\n  async componentDidLoad() {\n    const viewBodyHeight = this.elm.shadowRoot.querySelector('.view-body').scrollHeight;\n    this.elm.shadowRoot.querySelector('.view-body').scroll({\n      top: (this.getTimePercent(this.currentTime) / 100) * viewBodyHeight - 150,\n    });\n  }\n\n  renderHeader() {\n    const columns = [];\n    this.#forEachDayInDateRange(i => {\n      const cls = ['column'];\n      const diff = differenceInDays(startOfDay(i), startOfDay(this.currentTime));\n      if (diff === 0) cls.push('today');\n      else if (diff < 0) cls.push('past');\n      else if (diff < 0) cls.push('future');\n\n      columns.push(\n        <div class={cls.join(' ')}>\n          <div class=\"column-content\">\n            <div class=\"date\" onClick={() => this.goatColumnViewDateClick.emit({ date: i })}>\n              {format(i, 'dd')}\n            </div>\n            <div class=\"day\">{format(i, 'E')}</div>\n          </div>\n        </div>,\n      );\n    });\n    return columns;\n  }\n\n  renderMultiDayBackground() {\n    const columns = [];\n    for (let i = new Date(this.dateRange.startDate); differenceInDays(startOfDay(this.dateRange.endDate), i) >= 0; i = addDays(i, 1)) {\n      const cls = ['column'];\n      const diff = differenceInDays(startOfDay(i), startOfDay(this.currentTime));\n      if (diff === 0) cls.push('today');\n      else if (diff < 0) cls.push('past');\n      else if (diff < 0) cls.push('future');\n\n      columns.push(<div class={cls.join(' ')}></div>);\n    }\n    return columns;\n  }\n\n  renderScale() {\n    const rows = [];\n    for (let i = 0; i < 48; i++) {\n      // @TODO: parameterize number of column, currently rendering 24 hours\n      const cls = ['row'];\n      if (i % 2) cls.push('hour');\n      const startTime = startOfDay(new Date());\n      const row = (\n        <div class={cls.join(' ')}>\n          {(() => {\n            if (i % 2 == 0 && i) {\n              return <div class=\"time\">{format(addHours(startTime, i / 2), 'hh a')}</div>;\n            }\n          })()}\n        </div>\n      );\n      rows.push(row);\n    }\n    return <div class=\"background\">{rows}</div>;\n  }\n\n  renderEvents() {\n    const columns = [];\n    for (let i = new Date(this.dateRange.startDate), j = 0; differenceInDays(startOfDay(this.dateRange.endDate), i) >= 0; i = addDays(i, 1), j++) {\n      const cls = ['column'];\n      if (isEqual(startOfDay(i), startOfDay(this.currentTime))) cls.push('active');\n      columns.push(\n        <div class={cls.join(' ')}>\n          <div class=\"column-content\">\n            {(() => {\n              const eventDay = this.singleDayEvents[this.#getDateOnly(i)];\n              if (eventDay) {\n                const columnsLength = eventDay.length;\n\n                return eventDay.map((nodes, columnIndex) => {\n                  return nodes.map(node => {\n                    const cls = ['event'];\n                    if (this.eventClickable) cls.push('clickable');\n                    return (\n                      <div\n                        class={cls.join(' ')}\n                        onClick={() => {\n                          if (this.eventClickable) {\n                            this.goatColumnViewEventClick.emit({ event: node.data });\n                          }\n                        }}\n                        style={{\n                          top: `${this.getTimePercent(node.start, startOfDay(i))}%`,\n                          height: `${this.getTimePercent(node.end, startOfDay(i)) - this.getTimePercent(node.start, startOfDay(i))}%`,\n                          left: `${(columnIndex / columnsLength) * 100}%`,\n                          width: `calc(${((1 * node.width) / columnsLength) * 100}% - 1px)`,\n                        }}\n                      >\n                        <div class=\"event-title\">{node.title || '(no title)'}</div>\n                      </div>\n                    );\n                  });\n                });\n              }\n            })()}\n          </div>\n        </div>,\n      );\n    }\n    return <div class=\"events-container\">{columns}</div>;\n  }\n\n  renderMultiDayEvents() {\n    const eventDay = this.multiDayEvents;\n    if (eventDay && eventDay.length) {\n      return (\n        <div class=\"row-content\">\n          {eventDay.map((nodes) => {\n            return (\n              <div class=\"row\">\n                {nodes.map(node => {\n                  const cls = ['event'];\n                  if (this.eventClickable) cls.push('clickable');\n                  return (\n                    <div\n                      class={cls.join(' ')}\n                      onClick={() => {\n                        if (this.eventClickable) {\n                          this.goatColumnViewEventClick.emit({ event: node.data });\n                        }\n                      }}\n                      style={{\n                        left: `${this.getDatePercent(node.start)}%`,\n                        width: `${this.getDatePercent(addDays(node.end, 1)) - this.getDatePercent(node.start)}%`,\n                      }}\n                    >\n                      <div class=\"event-title\">{node.title || '(no title)'}</div>\n                    </div>\n                  );\n                })}\n              </div>\n            );\n          })}\n          <div class=\"row-spacer\"></div>\n        </div>\n      );\n    }\n  }\n\n  getDatePercent(date) {\n    const currentDay = differenceInDays(startOfDay(date), this.dateRange.startDate);\n    const percent = (currentDay / this.dateRange.totalDays) * 100;\n    if (percent < 0) return 0;\n    if (percent > 100) return 100;\n    return percent;\n  }\n\n  getTimePercent(date, forDay?) {\n    if (!forDay) forDay = date;\n    const startDate = startOfDay(forDay);\n    const endDate = endOfDay(forDay);\n    const percent = ((date.valueOf() - startDate.valueOf()) / (endDate.valueOf() - startDate.valueOf())) * 100;\n    if (percent < 0) return 0;\n    if (percent > 100) return 100;\n    return percent;\n  }\n\n  renderCurrentTime() {\n    if (this.currentTime.valueOf() > this.dateRange.startDate.valueOf() - 1 && this.currentTime.valueOf() < this.dateRange.endDate.valueOf() + 1) {\n      return (\n        <div class=\"current-time-line\" style={{ top: `calc(${this.getTimePercent(this.currentTime)}% - 1px)` }}>\n          <div class=\"time\">{format(this.contextDate, 'hh:mm a')}</div>\n          <div class=\"dash-line\" style={{ width: `${this.getDatePercent(this.currentTime)}%` }}></div>\n          <div class=\"dot\" style={{ left: `calc( ${this.getDatePercent(this.currentTime)}% - 0.25rem)` }}></div>\n          <div\n            class=\"line\"\n            style={{\n              left: `${this.getDatePercent(this.currentTime)}%`,\n              width: `${(1 / this.dateRange.totalDays) * 100}%`,\n            }}\n          ></div>\n        </div>\n      );\n    }\n  }\n\n  render() {\n    return (\n      <div class=\"calendar-column-view\">\n        <div class=\"view-header\">\n          <div class=\"scale\" />\n          <div class=\"columns\">{this.renderHeader()}</div>\n          <div class=\"scrollbar-placeholder\" />\n        </div>\n        <div class=\"multi-day-section-wrapper\">\n          <div class=\"multi-day-section-scroll\">\n            <div class=\"multi-day-section\">\n              <div class=\"multi-day-background\">\n                <div class=\"scale\" />\n                <div class=\"columns\">{this.renderMultiDayBackground()}</div>\n              </div>\n              <div class=\"multi-events\">{this.renderMultiDayEvents()}</div>\n            </div>\n          </div>\n        </div>\n        <div class=\"view-body\">\n          <div class=\"view-body-scroll\">\n            <div class=\"scale\">{this.renderScale()}</div>\n            <div class=\"drawing-area\">\n              <goat-calendar-column-view-background columns={this.dateRange.totalDays} />\n              {this.renderEvents()}\n            </div>\n            {this.renderCurrentTime()}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import { CalendarEvent } from '../CalendarEvent';\nimport { differenceInMilliseconds } from 'date-fns';\n\nexport class ColumnEvent extends CalendarEvent {\n  width: number = 1;\n\n  constructor(event: CalendarEvent) {\n    super(event.start, event.end, event.title, event.data);\n  }\n}\n\nexport default class MonthEventManager {\n\n  #events: ColumnEvent[] = [];\n\n  columns: ColumnEvent[][];\n\n  constructor() {\n\n  }\n\n  addEvents(events: CalendarEvent[]) {\n    events.forEach((event) => {\n      this.#events.push(new ColumnEvent(event));\n    });\n  }\n\n  process() {\n    this.columns = [];\n    let events = this.#events.sort((a, b) => {\n      return differenceInMilliseconds(a.start, b.start) || b.length() - a.length();\n    });\n\n    let oldLength = null;\n    /* Bucketing */\n    while (events.length) {\n      if (oldLength == events.length)\n        throw new Error('Events not processed in previous run, breaking infinite loop');\n      oldLength = events.length;\n\n      const column = [];\n      for (let i = 0; i < events.length; i++) {\n        if (i == 0)\n          column.push(events[i]);\n        else if (differenceInMilliseconds(events[i].start, column[column.length - 1].end) >= 0) {\n          column.push(events[i]);\n        }\n      }\n      this.columns.push(column);\n      events = events.filter((e) => {\n        return !column.find((ce) => {\n          return ce.gid == e.gid;\n        });\n      });\n    }\n\n    for (let i = 0; i < this.columns.length - 1; i++) {\n\n      this.columns[i].forEach((event) => {\n        for (let j = i + 1; j < this.columns.length; j++) {\n          if (this.columns[j].find((colEvent) => {\n            return event.isOverlapping(colEvent);\n          })) {\n            break;\n          }\n          event.width++;\n        }\n      });\n\n    }\n  }\n}\n","@import \"../../../../globalStyles/commons\";\r\n\r\n:host {\r\n  display: block;\r\n  height: 100%;\r\n  --calendar-border-color: #{v(--border-strong-01)};\r\n  --scale-size: 3rem;\r\n  --scale-color: #{v(--text-placeholder)}\r\n}\r\n\r\n.scale {\r\n  width: var(--scale-size);\r\n}\r\n\r\n.calendar-month-view {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n\r\n  .view-header {\r\n    border-top: 1px solid v(--border-strong-01);\r\n    border-bottom: 1px solid v(--border-strong-01);\r\n    display: flex;\r\n\r\n    .scale {\r\n      border-right: 1px solid v(--scale-color);\r\n    }\r\n\r\n    .columns {\r\n      display: flex;\r\n      flex: 1;\r\n\r\n      .column {\r\n        flex: 1;\r\n        border-right: 1px solid v(--scale-color);\r\n\r\n\r\n        .column-content {\r\n          display: flex;\r\n          align-items: center;\r\n          padding: .5rem;\r\n          gap: .5rem;\r\n        }\r\n\r\n        .date {\r\n          font-size: 2rem;\r\n          cursor: pointer;\r\n          border-radius: 100%;\r\n          padding: 0.5rem;\r\n        }\r\n\r\n        .day {\r\n          font-size: 1rem;\r\n        }\r\n      }\r\n    }\r\n\r\n    .scrollbar-placeholder {\r\n      width: var(--scrollbar-width);\r\n    }\r\n  }\r\n\r\n\r\n\r\n  .view-body {\r\n    height: 100%;\r\n    overflow-y: scroll;\r\n\r\n    .view-body-scroll {\r\n      display: flex;\r\n      position: relative;\r\n      min-height: 100%;\r\n\r\n      .drawing-area {\r\n        flex: 1;\r\n\r\n        .multi-day-section {\r\n          border-bottom: 1px solid v(--scale-color);\r\n          min-height: 9rem;\r\n          height: 20%;\r\n\r\n          .multi-day-body-scroll {\r\n            position: relative;\r\n            height: 100%\r\n          }\r\n\r\n          .multi-day-background {\r\n            display: flex;\r\n            height: 100%;\r\n            position: absolute;\r\n            width: 100%;\r\n\r\n            .scale {\r\n              border-inline-end: 1px solid v(--scale-color);\r\n            }\r\n\r\n            .columns {\r\n              display: flex;\r\n              flex: 1;\r\n\r\n              .column {\r\n                flex: 1;\r\n                border-right: 1px solid v(--scale-color);\r\n\r\n                .column-header {\r\n                  @include font-style(helper-text-01);\r\n                  padding-inline-start: .5rem;\r\n                  padding-top: .3rem;\r\n                  border-top: .2rem solid transparent;\r\n                }\r\n\r\n                &.today {\r\n                  background: v(--color-primary-10);\r\n                  .column-header {\r\n                    border-top-color: v(--color-primary);\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n\r\n          .multi-events {\r\n            min-height: 4rem;\r\n            padding-top: 2rem;\r\n            height: 100%;\r\n\r\n            .row {\r\n              height: 1.8rem;\r\n              box-sizing: content-box;\r\n              position: relative;\r\n              padding-bottom: .5rem;\r\n              &:last-child {\r\n                padding-bottom: 0;\r\n              }\r\n            }\r\n\r\n            .row-spacer {\r\n              height: 1rem;\r\n            }\r\n\r\n            .event {\r\n              background: v(--color-primary-30);\r\n              border-left: .25rem solid v(--color-primary);\r\n              border-radius: v(--border-radius);\r\n              position: absolute;\r\n              height: 1.8rem;\r\n              text-overflow: ellipsis;\r\n              overflow: hidden;\r\n\r\n              .event-title {\r\n                padding: 0.25rem;\r\n                @include font-style(body-01);\r\n              }\r\n\r\n              &.clickable {\r\n                cursor: pointer;\r\n\r\n                &:hover {\r\n                  background: v(--color-primary-40);\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      .current-time-line {\r\n        position: absolute;\r\n        z-index: 100;\r\n        pointer-events: none;\r\n        width: calc(100% - var(--scale-size));\r\n        margin-inline-start: var(--scale-size);\r\n\r\n        .time {\r\n          position: absolute;\r\n          font-size: .5rem;\r\n          font-weight: 600;\r\n          color: v(--color-primary);\r\n          top: -6px;\r\n          left: -3rem;\r\n          background: v(--color-primary-10);\r\n          padding: 2px;\r\n          border-radius: 3px;\r\n        }\r\n\r\n        .dash-line {\r\n          position: absolute;\r\n          left: 0;\r\n          border-bottom: 1px dashed v(--color-primary);\r\n        }\r\n\r\n        .dot {\r\n          border-radius: 100%;\r\n          width: 0.5rem;\r\n          height: 0.5rem;\r\n          background: v(--color-primary);\r\n          display: block;\r\n          position: absolute;\r\n          top: -0.25rem;\r\n        }\r\n\r\n        .line {\r\n          border-bottom: 2px solid v(--color-primary);\r\n          position: absolute;\r\n          top: -1px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { Component, ComponentInterface, Element, Event, EventEmitter, h, Prop } from '@stencil/core';\r\nimport { addDays, addHours, differenceInDays, endOfDay, format, startOfDay } from 'date-fns';\r\nimport MonthEventManager from './MonthEventManager';\r\nimport { BaseEvent } from '../event-management/BaseEvent';\r\nimport { calculateMonthRange } from '../utils';\r\n\r\n@Component({\r\n  tag: 'goat-calendar-month-view',\r\n  styleUrl: 'month-view.scss',\r\n  shadow: true,\r\n})\r\nexport class CalendarMonthView implements ComponentInterface {\r\n  @Element() elm!: HTMLElement;\r\n\r\n  @Prop() events: any[] = [];\r\n\r\n  @Prop() eventClickable: boolean = true;\r\n\r\n  @Prop() currentTime: Date;\r\n\r\n  @Prop() contextDate: Date;\r\n\r\n  dateRange: any;\r\n\r\n  weekDayEvents: any = [];\r\n\r\n  @Event({ eventName: 'goat:month-view-date-click' }) goatMonthViewDateClick: EventEmitter;\r\n\r\n  @Event({ eventName: 'goat:month-view-event-click' }) goatMonthViewEventClick: EventEmitter;\r\n\r\n  async componentWillRender() {\r\n    this.dateRange = calculateMonthRange(this.contextDate, 1 /* monday */);\r\n    this.weekDayEvents = [];\r\n    for (let i = new Date(this.dateRange.startDate), j = 0; j < 5; i = addDays(i, 7), j++) {\r\n      const manager = new MonthEventManager();\r\n      manager.addEvents(\r\n        this.events.filter(event => {\r\n          return event.isOverlapping(new BaseEvent(startOfDay(i), endOfDay(addDays(i, 6))));\r\n        }),\r\n      );\r\n      manager.process();\r\n      this.weekDayEvents.push(manager.columns);\r\n    }\r\n  }\r\n\r\n  async componentDidLoad() {\r\n    const viewBodyHeight = this.elm.shadowRoot.querySelector('.view-body').scrollHeight;\r\n    this.elm.shadowRoot.querySelector('.view-body').scroll({\r\n      top: (this.getTimePercent(this.currentTime) / 100) * viewBodyHeight - 150,\r\n    });\r\n  }\r\n\r\n  renderHeader() {\r\n    const columns = [];\r\n    for (let i = new Date(this.dateRange.startDate), j = 0; j < 7; i = addDays(i, 1), j++) {\r\n      const cls = ['column'];\r\n      columns.push(\r\n        <div class={cls.join(' ')}>\r\n          <div class=\"column-content\">\r\n            <div class=\"day\">{format(i, 'EEEE')}</div>\r\n          </div>\r\n        </div>,\r\n      );\r\n    }\r\n    return columns;\r\n  }\r\n\r\n  renderMultiDayBackground(startDate) {\r\n    const columns = [];\r\n    for (let i = new Date(startDate), j = 0; j < 7; i = addDays(i, 1), j++) {\r\n      const cls = ['column'];\r\n      const diff = differenceInDays(startOfDay(i), startOfDay(this.currentTime));\r\n      if (diff === 0) cls.push('today');\r\n      else if (diff < 0) cls.push('past');\r\n      else if (diff < 0) cls.push('future');\r\n      columns.push(\r\n        <div class={cls.join(' ')}>\r\n          <div class=\"column-content\">\r\n            <div class=\"column-header\">\r\n              <div class=\"day\">{format(i, 'd')}</div>\r\n            </div>\r\n          </div>\r\n        </div>,\r\n      );\r\n    }\r\n    return columns;\r\n  }\r\n\r\n  renderScale() {\r\n    const rows = [];\r\n    for (let i = 0; i < 48; i++) {\r\n      // @TODO: parameterize number of column, currently rendering 24 hours\r\n      const cls = ['row'];\r\n      if (i % 2) cls.push('hour');\r\n      const startTime = startOfDay(new Date());\r\n      const row = (\r\n        <div class={cls.join(' ')}>\r\n          {(() => {\r\n            if (i % 2 == 0 && i) {\r\n              return <div class=\"time\">{format(addHours(startTime, i / 2), 'hh a')}</div>;\r\n            }\r\n          })()}\r\n        </div>\r\n      );\r\n      rows.push(row);\r\n    }\r\n    return <div class=\"background\">{rows}</div>;\r\n  }\r\n\r\n  renderEvents() {\r\n    const eventPadding = 0.25;\r\n\r\n    return this.weekDayEvents.map((eventDay, index) => {\r\n      return (\r\n        <div class=\"multi-day-section\">\r\n          <div class=\"multi-day-body-scroll\">\r\n            <div class=\"multi-day-background\">\r\n              <div class=\"columns\">{this.renderMultiDayBackground(addDays(this.dateRange.startDate, index * 7))}</div>\r\n            </div>\r\n            <div class=\"multi-events\">\r\n              <div class=\"row-content\">\r\n                {eventDay.map(nodes => {\r\n                  return (\r\n                    <div class=\"row\">\r\n                      {nodes.map(node => {\r\n                        const cls = ['event'];\r\n                        if (this.eventClickable) cls.push('clickable');\r\n                        return (\r\n                          <div\r\n                            class={cls.join(' ')}\r\n                            onClick={() => {\r\n                              if (this.eventClickable) {\r\n                                this.goatMonthViewEventClick.emit({ event: node.data });\r\n                              }\r\n                            }}\r\n                            style={{\r\n                              left: `${this.getDatePercent(node.start, { startDate: addDays(this.dateRange.startDate, index * 7) }) + eventPadding}%`,\r\n                              width: `${\r\n                                this.getDatePercent(addDays(node.end, 1), { startDate: addDays(this.dateRange.startDate, index * 7) }) -\r\n                                this.getDatePercent(node.start, { startDate: addDays(this.dateRange.startDate, index * 7) }) -\r\n                                2 * eventPadding\r\n                              }%`,\r\n                            }}\r\n                          >\r\n                            <div class=\"event-title\">{node.title || '(no title)'}</div>\r\n                          </div>\r\n                        );\r\n                      })}\r\n                    </div>\r\n                  );\r\n                })}\r\n                <div class=\"row-spacer\"></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    });\r\n  }\r\n\r\n  getDatePercent(date, dateRange) {\r\n    const currentDay = differenceInDays(startOfDay(date), dateRange.startDate);\r\n    const percent = (currentDay / 7) * 100;\r\n    if (percent < 0) return 0;\r\n    if (percent > 100) return 100;\r\n    return percent;\r\n  }\r\n\r\n  getTimePercent(date, forDay?) {\r\n    if (!forDay) forDay = date;\r\n    const startDate = startOfDay(forDay);\r\n    const endDate = endOfDay(forDay);\r\n    const percent = ((date.valueOf() - startDate.valueOf()) / (endDate.valueOf() - startDate.valueOf())) * 100;\r\n    if (percent < 0) return 0;\r\n    if (percent > 100) return 100;\r\n    return percent;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div class=\"calendar-month-view\">\r\n        <div class=\"view-header\">\r\n          <div class=\"columns\">{this.renderHeader()}</div>\r\n          <div class=\"scrollbar-placeholder\" />\r\n        </div>\r\n\r\n        <div class=\"view-body\">\r\n          <div class=\"view-body-scroll\">\r\n            <div class=\"drawing-area\">{this.renderEvents()}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"+NAGA,IAAIA,EAAuB,KAoBZ,SAASC,EAASC,EAAWC,GAC1CC,EAAa,EAAGC,WAChB,IAAIC,EAASC,EAAUJ,GACvB,OAAOK,EAAgBN,EAAWI,EAASN,EAC7C,CCIe,SAASS,EAAYP,EAAWQ,GAC7C,IAAIC,EAAMC,EAAOC,EAAOC,EAAuBC,EAAiBC,EAAuBC,EAAuBC,EAC9Gd,EAAa,EAAGC,WAChB,IAAIc,EAAiBC,IACrB,IAAIC,EAAed,GAAWI,GAAQC,GAASC,GAASC,EAAwBJ,IAAY,MAAQA,SAAiB,OAAS,EAAIA,EAAQW,gBAAkB,MAAQP,SAA+B,EAAIA,EAAwBJ,IAAY,MAAQA,SAAiB,OAAS,GAAKK,EAAkBL,EAAQY,UAAY,MAAQP,SAAyB,OAAS,GAAKC,EAAwBD,EAAgBL,WAAa,MAAQM,SAA+B,OAAS,EAAIA,EAAsBK,gBAAkB,MAAQR,SAAe,EAAIA,EAAQM,EAAeE,gBAAkB,MAAQT,SAAe,EAAIA,GAASK,EAAwBE,EAAeG,UAAY,MAAQL,SAA+B,OAAS,GAAKC,EAAyBD,EAAsBP,WAAa,MAAQQ,SAAgC,OAAS,EAAIA,EAAuBG,gBAAkB,MAAQV,SAAc,EAAIA,EAAO,GAGn4B,KAAMU,GAAgB,GAAKA,GAAgB,GAAI,CAC7C,MAAM,IAAIE,WAAW,mDACzB,CACE,IAAIC,EAAOC,EAAOvB,GAClB,IAAIwB,EAAMF,EAAKG,SACf,IAAIC,GAAQF,EAAML,EAAe,EAAI,GAAKK,EAAML,EAChDG,EAAKK,QAAQL,EAAKM,UAAYF,GAC9BJ,EAAKO,SAAS,EAAG,EAAG,EAAG,GACvB,OAAOP,CACT,CC5CA,IAAIQ,EAAsB,MAgCX,SAASC,EAAyBC,EAAeC,GAC9D/B,EAAa,EAAGC,WAChB,IAAI+B,EAAiBC,EAAWH,GAChC,IAAII,EAAkBD,EAAWF,GACjC,IAAII,EAAgBH,EAAeI,UAAYC,EAAgCL,GAC/E,IAAIM,EAAiBJ,EAAgBE,UAAYC,EAAgCH,GAKjF,OAAOK,KAAKC,OAAOL,EAAgBG,GAAkBV,EACvD,CCxCA,SAASa,EAAgBC,EAAUC,GACjC,IAAInB,EAAOkB,EAASE,cAAgBD,EAAUC,eAAiBF,EAASG,WAAaF,EAAUE,YAAcH,EAAShB,UAAYiB,EAAUjB,WAAagB,EAASI,WAAaH,EAAUG,YAAcJ,EAASK,aAAeJ,EAAUI,cAAgBL,EAASM,aAAeL,EAAUK,cAAgBN,EAASO,kBAAoBN,EAAUM,kBAClV,GAAIzB,EAAO,EAAG,CACZ,OAAQ,CACZ,MAAS,GAAIA,EAAO,EAAG,CACnB,OAAO,CAEX,KAAS,CACL,OAAOA,CACX,CACA,CAmDe,SAAS0B,EAAiBpB,EAAeC,GACtD/B,EAAa,EAAGC,WAChB,IAAIyC,EAAWrB,EAAOS,GACtB,IAAIa,EAAYtB,EAAOU,GACvB,IAAIoB,EAAOV,EAAgBC,EAAUC,GACrC,IAAIS,EAAab,KAAKc,IAAIxB,EAAyBa,EAAUC,IAC7DD,EAASjB,QAAQiB,EAAShB,UAAYyB,EAAOC,GAI7C,IAAIE,EAAmBC,OAAOd,EAAgBC,EAAUC,MAAgBQ,GACxE,IAAIK,EAASL,GAAQC,EAAaE,GAElC,OAAOE,IAAW,EAAI,EAAIA,CAC5B,CCzDe,SAASC,EAAyBf,EAAUC,GACzD3C,EAAa,EAAGC,WAChB,OAAOoB,EAAOqB,GAAUN,UAAYf,EAAOsB,GAAWP,SACxD,CCPe,SAASsB,EAAS5D,GAC/BE,EAAa,EAAGC,WAChB,IAAImB,EAAOC,EAAOvB,GAClBsB,EAAKO,SAAS,GAAI,GAAI,GAAI,KAC1B,OAAOP,CACT,CCLe,SAASuC,EAAW7D,GACjCE,EAAa,EAAGC,WAChB,IAAImB,EAAOC,EAAOvB,GAClB,IAAI8D,EAAQxC,EAAKyB,WACjBzB,EAAKyC,YAAYzC,EAAKwB,cAAegB,EAAQ,EAAG,GAChDxC,EAAKO,SAAS,GAAI,GAAI,GAAI,KAC1B,OAAOP,CACT,CCPe,SAAS0C,EAAahE,GACnCE,EAAa,EAAGC,WAChB,IAAImB,EAAOC,EAAOvB,GAClBsB,EAAKK,QAAQ,GACbL,EAAKO,SAAS,EAAG,EAAG,EAAG,GACvB,OAAOP,CACT,CCKe,SAAS2C,EAAUjE,EAAWQ,GAC3C,IAAIC,EAAMC,EAAOC,EAAOC,EAAuBC,EAAiBC,EAAuBC,EAAuBC,EAC9Gd,EAAa,EAAGC,WAChB,IAAIc,EAAiBC,IACrB,IAAIC,EAAed,GAAWI,GAAQC,GAASC,GAASC,EAAwBJ,IAAY,MAAQA,SAAiB,OAAS,EAAIA,EAAQW,gBAAkB,MAAQP,SAA+B,EAAIA,EAAwBJ,IAAY,MAAQA,SAAiB,OAAS,GAAKK,EAAkBL,EAAQY,UAAY,MAAQP,SAAyB,OAAS,GAAKC,EAAwBD,EAAgBL,WAAa,MAAQM,SAA+B,OAAS,EAAIA,EAAsBK,gBAAkB,MAAQR,SAAe,EAAIA,EAAQM,EAAeE,gBAAkB,MAAQT,SAAe,EAAIA,GAASK,EAAwBE,EAAeG,UAAY,MAAQL,SAA+B,OAAS,GAAKC,EAAyBD,EAAsBP,WAAa,MAAQQ,SAAgC,OAAS,EAAIA,EAAuBG,gBAAkB,MAAQV,SAAc,EAAIA,EAAO,GAGn4B,KAAMU,GAAgB,GAAKA,GAAgB,GAAI,CAC7C,MAAM,IAAIE,WAAW,mDACzB,CACE,IAAIC,EAAOC,EAAOvB,GAClB,IAAIwB,EAAMF,EAAKG,SACf,IAAIC,GAAQF,EAAML,GAAgB,EAAI,GAAK,GAAKK,EAAML,GACtDG,EAAKK,QAAQL,EAAKM,UAAYF,GAC9BJ,EAAKO,SAAS,GAAI,GAAI,GAAI,KAC1B,OAAOP,CACT,C,SCvCgB4C,EAAoB5C,EAAMH,EAA0C,GAClF,MAAMgD,EAAY5D,EAAYyD,EAAa1C,GAAO,CAAEH,iBACpD,MAAMiD,EAAUH,EAAUJ,EAAWvC,GAAO,CAAEH,iBAC9C,MAAO,CACLgD,YACAC,UACAC,UAAW,GAEf,C,SAKgBC,EAAmBhD,EAAMH,EAA0C,GACjF,MAAMgD,EAAY5D,EAAYe,EAAM,CAAEH,iBACtC,MAAMiD,EAAUH,EAAU3C,EAAM,CAAEH,iBAClC,MAAO,CACLgD,YACAC,UACAC,UAAW,EAEf,C,SC1BgBE,EAAmBC,EAAMC,EAAaC,GACpD,GAAIF,IAAS,OAAQ,CACnB,OAAOF,EAAmBG,EAAa,E,KAClC,CACL,MAAME,EAAiB,GACvBA,EAAUR,UAAYhC,EAAWsC,GACjCE,EAAUP,QAAUR,EAASgB,EAAQH,EAAaC,EAAO,IACzDC,EAAUN,UAAYK,EACtB,OAAOC,C,CAEX,C,yWCVaE,UAAoBC,EAG/B,WAAAC,CAAYC,GACVC,MAAMD,EAAME,MAAOF,EAAMG,IAAKH,EAAMI,MAAOJ,EAAMK,MAHnDC,KAAAC,MAAgB,C,EAOlB,MAAqBC,EAMnB,WAAAT,GAJAU,EAAAC,IAAAJ,KAAyB,G,CAQzB,SAAAK,CAAUC,GACRA,EAAOC,SAASb,IACdc,EAAAR,KAAIG,EAAA,KAASM,KAAK,IAAIlB,EAAYG,GAAO,G,CAI7C,OAAAgB,GACEV,KAAKW,QAAU,GACf,IAAIL,EAASE,EAAAR,KAAIG,EAAA,KAASS,MAAK,CAACC,EAAGC,IAC1BzC,EAAyBwC,EAAEjB,MAAOkB,EAAElB,QAAUkB,EAAEC,SAAWF,EAAEE,WAGtE,IAAIC,EAAY,KAEhB,MAAOV,EAAOS,OAAQ,CACpB,GAAIC,GAAaV,EAAOS,OACtB,MAAM,IAAIE,MAAM,gEAClBD,EAAYV,EAAOS,OAEnB,MAAMG,EAAS,GACf,IAAK,IAAIC,EAAI,EAAGA,EAAIb,EAAOS,OAAQI,IAAK,CACtC,GAAIA,GAAK,EACPD,EAAOT,KAAKH,EAAOa,SAChB,GAAI9C,EAAyBiC,EAAOa,GAAGvB,MAAOsB,EAAOA,EAAOH,OAAS,GAAGlB,MAAQ,EAAG,CACtFqB,EAAOT,KAAKH,EAAOa,G,EAGvBnB,KAAKW,QAAQF,KAAKS,GAClBZ,EAASA,EAAOc,QAAQC,IACdH,EAAOI,MAAMC,GACZA,EAAGC,KAAOH,EAAEG,O,CAKzB,IAAK,IAAIL,EAAI,EAAGA,EAAInB,KAAKW,QAAQI,OAAS,EAAGI,IAAK,CAEhDnB,KAAKW,QAAQQ,GAAGZ,SAASb,IACvB,IAAK,IAAI+B,EAAIN,EAAI,EAAGM,EAAIzB,KAAKW,QAAQI,OAAQU,IAAK,CAChD,GAAIzB,KAAKW,QAAQc,GAAGH,MAAMI,GACjBhC,EAAMiC,cAAcD,KACzB,CACF,K,CAEFhC,EAAMO,O,qBCjEhB,MAAM2B,EAAgB,28O,6WCWTC,EAAkB,M,iLAiB7B7B,KAAA8B,gBAAuB,GACvB9B,KAAA+B,eAAsB,G,YAfE,G,UAET,O,UAEA,E,oBAEmB,K,sDAelC,yBAAMC,GACJhC,KAAKX,UAAYJ,EAAmBe,KAAKd,KAAMc,KAAKb,YAAaa,KAAKZ,MACtEY,KAAK8B,gBAAkB,GACvBtB,EAAAR,KAAIiC,EAAA,IAAAC,GAAuBC,KAA3BnC,MAA4BmB,IAC1B,MAAMiB,EAAU,IAAIlC,EACpBkC,EAAQ/B,UACNL,KAAKM,OAAOc,QAAO1B,GACVA,EAAMiC,cAAc,IAAIU,EAAUxF,EAAWsE,GAAI7C,EAAS6C,MAAQzB,EAAMqB,SAAW,SAG9FqB,EAAQ1B,UACRV,KAAK8B,gBAAgBtB,EAAAR,KAAIiC,EAAA,IAAAK,GAAaH,KAAjBnC,KAAkBmB,IAAMiB,EAAQzB,OAAO,IAE9D,MAAMyB,EAAU,IAAIlC,EACpBkC,EAAQ/B,UAAUL,KAAKM,OAAOc,QAAO1B,GAC5BA,EAAMiC,cAAc,IAAIU,EAAUrC,KAAKX,UAAUR,UAAWmB,KAAKX,UAAUP,WAAaY,EAAMqB,UAAY,SAEnHqB,EAAQ1B,UACRV,KAAK+B,eAAiBK,EAAQzB,O,CAahC,sBAAM4B,GACJ,MAAMC,EAAiBxC,KAAKyC,IAAIC,WAAWC,cAAc,cAAcC,aACvE5C,KAAKyC,IAAIC,WAAWC,cAAc,cAAcE,OAAO,CACrDC,IAAM9C,KAAK+C,eAAe/C,KAAKgD,aAAe,IAAOR,EAAiB,K,CAI1E,YAAAS,GACE,MAAMtC,EAAU,GAChBH,EAAAR,KAAIiC,EAAA,IAAAC,GAAuBC,KAA3BnC,MAA4BmB,IAC1B,MAAM+B,EAAM,CAAC,UACb,MAAM9G,EAAO0B,EAAiBjB,EAAWsE,GAAItE,EAAWmD,KAAKgD,cAC7D,GAAI5G,IAAS,EAAG8G,EAAIzC,KAAK,cACpB,GAAIrE,EAAO,EAAG8G,EAAIzC,KAAK,aACvB,GAAIrE,EAAO,EAAG8G,EAAIzC,KAAK,UAE5BE,EAAQF,KACN0C,EAAA,OAAKC,MAAOF,EAAIG,KAAK,MACnBF,EAAA,OAAKC,MAAM,kBACTD,EAAA,OAAKC,MAAM,OAAOE,QAAS,IAAMtD,KAAKuD,wBAAwBC,KAAK,CAAExH,KAAMmF,KACxEsC,EAAOtC,EAAG,OAEbgC,EAAA,OAAKC,MAAM,OAAOK,EAAOtC,EAAG,QAGjC,IAEH,OAAOR,C,CAGT,wBAAA+C,GACE,MAAM/C,EAAU,GAChB,IAAK,IAAIQ,EAAI,IAAIwC,KAAK3D,KAAKX,UAAUR,WAAYf,EAAiBjB,EAAWmD,KAAKX,UAAUP,SAAUqC,IAAM,EAAGA,EAAI7B,EAAQ6B,EAAG,GAAI,CAChI,MAAM+B,EAAM,CAAC,UACb,MAAM9G,EAAO0B,EAAiBjB,EAAWsE,GAAItE,EAAWmD,KAAKgD,cAC7D,GAAI5G,IAAS,EAAG8G,EAAIzC,KAAK,cACpB,GAAIrE,EAAO,EAAG8G,EAAIzC,KAAK,aACvB,GAAIrE,EAAO,EAAG8G,EAAIzC,KAAK,UAE5BE,EAAQF,KAAK0C,EAAA,OAAKC,MAAOF,EAAIG,KAAK,O,CAEpC,OAAO1C,C,CAGT,WAAAiD,GACE,MAAMC,EAAO,GACb,IAAK,IAAI1C,EAAI,EAAGA,EAAI,GAAIA,IAAK,CAE3B,MAAM+B,EAAM,CAAC,OACb,GAAI/B,EAAI,EAAG+B,EAAIzC,KAAK,QACpB,MAAMqD,EAAYjH,EAAW,IAAI8G,MACjC,MAAMI,EACJZ,EAAA,OAAKC,MAAOF,EAAIG,KAAK,MAClB,MACC,GAAIlC,EAAI,GAAK,GAAKA,EAAG,CACnB,OAAOgC,EAAA,OAAKC,MAAM,QAAQK,EAAOhJ,EAASqJ,EAAW3C,EAAI,GAAI,Q,CAEhE,EAJA,IAOL0C,EAAKpD,KAAKsD,E,CAEZ,OAAOZ,EAAA,OAAKC,MAAM,cAAcS,E,CAGlC,YAAAG,GACE,MAAMrD,EAAU,GAChB,IAAK,IAAIQ,EAAI,IAAIwC,KAAK3D,KAAKX,UAAUR,WAAY4C,EAAI,EAAG3D,EAAiBjB,EAAWmD,KAAKX,UAAUP,SAAUqC,IAAM,EAAGA,EAAI7B,EAAQ6B,EAAG,GAAIM,IAAK,CAC5I,MAAMyB,EAAM,CAAC,UACb,GAAIe,EAAQpH,EAAWsE,GAAItE,EAAWmD,KAAKgD,cAAeE,EAAIzC,KAAK,UACnEE,EAAQF,KACN0C,EAAA,OAAKC,MAAOF,EAAIG,KAAK,MACnBF,EAAA,OAAKC,MAAM,kBACR,MACC,MAAMc,EAAWlE,KAAK8B,gBAAgBtB,EAAAR,KAAIiC,EAAA,IAAAK,GAAaH,KAAjBnC,KAAkBmB,IACxD,GAAI+C,EAAU,CACZ,MAAMC,EAAgBD,EAASnD,OAE/B,OAAOmD,EAASE,KAAI,CAACC,EAAOC,IACnBD,EAAMD,KAAIG,IACf,MAAMrB,EAAM,CAAC,SACb,GAAIlD,KAAKwE,eAAgBtB,EAAIzC,KAAK,aAClC,OACE0C,EAAA,OACEC,MAAOF,EAAIG,KAAK,KAChBC,QAAS,KACP,GAAItD,KAAKwE,eAAgB,CACvBxE,KAAKyE,yBAAyBjB,KAAK,CAAE9D,MAAO6E,EAAKxE,M,GAGrD2E,MAAO,CACL5B,IAAK,GAAG9C,KAAK+C,eAAewB,EAAK3E,MAAO/C,EAAWsE,OACnDwD,OAAQ,GAAG3E,KAAK+C,eAAewB,EAAK1E,IAAKhD,EAAWsE,IAAMnB,KAAK+C,eAAewB,EAAK3E,MAAO/C,EAAWsE,OACrGyD,KAAM,GAAIN,EAAcH,EAAiB,OACzClE,MAAO,QAAU,EAAIsE,EAAKtE,MAASkE,EAAiB,gBAGtDhB,EAAA,OAAKC,MAAM,eAAemB,EAAKzE,OAAS,cACpC,K,CAKf,EA9BA,K,CAmCT,OAAOqD,EAAA,OAAKC,MAAM,oBAAoBzC,E,CAGxC,oBAAAkE,GACE,MAAMX,EAAWlE,KAAK+B,eACtB,GAAImC,GAAYA,EAASnD,OAAQ,CAC/B,OACEoC,EAAA,OAAKC,MAAM,eACRc,EAASE,KAAKC,GAEXlB,EAAA,OAAKC,MAAM,OACRiB,EAAMD,KAAIG,IACT,MAAMrB,EAAM,CAAC,SACb,GAAIlD,KAAKwE,eAAgBtB,EAAIzC,KAAK,aAClC,OACE0C,EAAA,OACEC,MAAOF,EAAIG,KAAK,KAChBC,QAAS,KACP,GAAItD,KAAKwE,eAAgB,CACvBxE,KAAKyE,yBAAyBjB,KAAK,CAAE9D,MAAO6E,EAAKxE,M,GAGrD2E,MAAO,CACLE,KAAM,GAAG5E,KAAK8E,eAAeP,EAAK3E,UAClCK,MAAO,GAAGD,KAAK8E,eAAexF,EAAQiF,EAAK1E,IAAK,IAAMG,KAAK8E,eAAeP,EAAK3E,YAGjFuD,EAAA,OAAKC,MAAM,eAAemB,EAAKzE,OAAS,cACpC,OAMhBqD,EAAA,OAAKC,MAAM,e,EAMnB,cAAA0B,CAAe9I,GACb,MAAM+I,EAAajH,EAAiBjB,EAAWb,GAAOgE,KAAKX,UAAUR,WACrE,MAAMmG,EAAWD,EAAa/E,KAAKX,UAAUN,UAAa,IAC1D,GAAIiG,EAAU,EAAG,OAAO,EACxB,GAAIA,EAAU,IAAK,OAAO,IAC1B,OAAOA,C,CAGT,cAAAjC,CAAe/G,EAAMiJ,GACnB,IAAKA,EAAQA,EAASjJ,EACtB,MAAM6C,EAAYhC,EAAWoI,GAC7B,MAAMnG,EAAUR,EAAS2G,GACzB,MAAMD,GAAYhJ,EAAKkJ,UAAYrG,EAAUqG,YAAcpG,EAAQoG,UAAYrG,EAAUqG,WAAc,IACvG,GAAIF,EAAU,EAAG,OAAO,EACxB,GAAIA,EAAU,IAAK,OAAO,IAC1B,OAAOA,C,CAGT,iBAAAG,GACE,GAAInF,KAAKgD,YAAYkC,UAAYlF,KAAKX,UAAUR,UAAUqG,UAAY,GAAKlF,KAAKgD,YAAYkC,UAAYlF,KAAKX,UAAUP,QAAQoG,UAAY,EAAG,CAC5I,OACE/B,EAAA,OAAKC,MAAM,oBAAoBsB,MAAO,CAAE5B,IAAK,QAAQ9C,KAAK+C,eAAe/C,KAAKgD,yBAC5EG,EAAA,OAAKC,MAAM,QAAQK,EAAOzD,KAAKb,YAAa,YAC5CgE,EAAA,OAAKC,MAAM,YAAYsB,MAAO,CAAEzE,MAAO,GAAGD,KAAK8E,eAAe9E,KAAKgD,mBACnEG,EAAA,OAAKC,MAAM,MAAMsB,MAAO,CAAEE,KAAM,SAAS5E,KAAK8E,eAAe9E,KAAKgD,8BAClEG,EAAA,OACEC,MAAM,OACNsB,MAAO,CACLE,KAAM,GAAG5E,KAAK8E,eAAe9E,KAAKgD,gBAClC/C,MAAO,GAAI,EAAID,KAAKX,UAAUN,UAAa,U,EAQvD,MAAAqG,GACE,OACEjC,EAAA,OAAKC,MAAM,wBACTD,EAAA,OAAKC,MAAM,eACTD,EAAA,OAAKC,MAAM,UACXD,EAAA,OAAKC,MAAM,WAAWpD,KAAKiD,gBAC3BE,EAAA,OAAKC,MAAM,2BAEbD,EAAA,OAAKC,MAAM,6BACTD,EAAA,OAAKC,MAAM,4BACTD,EAAA,OAAKC,MAAM,qBACTD,EAAA,OAAKC,MAAM,wBACTD,EAAA,OAAKC,MAAM,UACXD,EAAA,OAAKC,MAAM,WAAWpD,KAAK0D,6BAE7BP,EAAA,OAAKC,MAAM,gBAAgBpD,KAAK6E,2BAItC1B,EAAA,OAAKC,MAAM,aACTD,EAAA,OAAKC,MAAM,oBACTD,EAAA,OAAKC,MAAM,SAASpD,KAAK4D,eACzBT,EAAA,OAAKC,MAAM,gBACTD,EAAA,wCAAsCxC,QAASX,KAAKX,UAAUN,YAC7DiB,KAAKgE,gBAEPhE,KAAKmF,sB,uDA7NOE,GACrB,IAAK,IAAIlE,EAAI,IAAIwC,KAAK3D,KAAKX,UAAUR,WAAYf,EAAiBjB,EAAWmD,KAAKX,UAAUP,SAAUqC,IAAM,EAAGA,EAAI7B,EAAQ6B,EAAG,GAAI,CAChIkE,EAASlE,E,CAEb,EAACmB,EAAA,SAAAA,EAEYtG,GACX,OAAOyH,EAAOzH,EAAM,aACtB,E,mXC7DWuD,UAAoBC,EAG/B,WAAAC,CAAYC,GACVC,MAAMD,EAAME,MAAOF,EAAMG,IAAKH,EAAMI,MAAOJ,EAAMK,MAHnDC,KAAAC,MAAgB,C,EAOlB,MAAqBqF,EAMnB,WAAA7F,GAJA8F,EAAAnF,IAAAJ,KAAyB,G,CAQzB,SAAAK,CAAUC,GACRA,EAAOC,SAASb,IACdc,EAAAR,KAAIuF,EAAA,KAAS9E,KAAK,IAAIlB,EAAYG,GAAO,G,CAI7C,OAAAgB,GACEV,KAAKW,QAAU,GACf,IAAIL,EAASE,EAAAR,KAAIuF,EAAA,KAAS3E,MAAK,CAACC,EAAGC,IAC1BzC,EAAyBwC,EAAEjB,MAAOkB,EAAElB,QAAUkB,EAAEC,SAAWF,EAAEE,WAGtE,IAAIC,EAAY,KAEhB,MAAOV,EAAOS,OAAQ,CACpB,GAAIC,GAAaV,EAAOS,OACtB,MAAM,IAAIE,MAAM,gEAClBD,EAAYV,EAAOS,OAEnB,MAAMG,EAAS,GACf,IAAK,IAAIC,EAAI,EAAGA,EAAIb,EAAOS,OAAQI,IAAK,CACtC,GAAIA,GAAK,EACPD,EAAOT,KAAKH,EAAOa,SAChB,GAAI9C,EAAyBiC,EAAOa,GAAGvB,MAAOsB,EAAOA,EAAOH,OAAS,GAAGlB,MAAQ,EAAG,CACtFqB,EAAOT,KAAKH,EAAOa,G,EAGvBnB,KAAKW,QAAQF,KAAKS,GAClBZ,EAASA,EAAOc,QAAQC,IACdH,EAAOI,MAAMC,GACZA,EAAGC,KAAOH,EAAEG,O,CAKzB,IAAK,IAAIL,EAAI,EAAGA,EAAInB,KAAKW,QAAQI,OAAS,EAAGI,IAAK,CAEhDnB,KAAKW,QAAQQ,GAAGZ,SAASb,IACvB,IAAK,IAAI+B,EAAIN,EAAI,EAAGM,EAAIzB,KAAKW,QAAQI,OAAQU,IAAK,CAChD,GAAIzB,KAAKW,QAAQc,GAAGH,MAAMI,GACjBhC,EAAMiC,cAAcD,KACzB,CACF,K,CAEFhC,EAAMO,O,qBCjEhB,MAAMuF,EAAe,0rM,MCWRC,EAAiB,M,iKAa5BzF,KAAA0F,cAAqB,G,YAVG,G,oBAEU,K,sDAclC,yBAAM1D,GACJhC,KAAKX,UAAYT,EAAoBoB,KAAKb,YAAa,GACvDa,KAAK0F,cAAgB,GACrB,IAAK,IAAIvE,EAAI,IAAIwC,KAAK3D,KAAKX,UAAUR,WAAY4C,EAAI,EAAGA,EAAI,EAAGN,EAAI7B,EAAQ6B,EAAG,GAAIM,IAAK,CACrF,MAAMW,EAAU,IAAIkD,EACpBlD,EAAQ/B,UACNL,KAAKM,OAAOc,QAAO1B,GACVA,EAAMiC,cAAc,IAAIU,EAAUxF,EAAWsE,GAAI7C,EAASgB,EAAQ6B,EAAG,SAGhFiB,EAAQ1B,UACRV,KAAK0F,cAAcjF,KAAK2B,EAAQzB,Q,EAIpC,sBAAM4B,GACJ,MAAMC,EAAiBxC,KAAKyC,IAAIC,WAAWC,cAAc,cAAcC,aACvE5C,KAAKyC,IAAIC,WAAWC,cAAc,cAAcE,OAAO,CACrDC,IAAM9C,KAAK+C,eAAe/C,KAAKgD,aAAe,IAAOR,EAAiB,K,CAI1E,YAAAS,GACE,MAAMtC,EAAU,GAChB,IAAK,IAAIQ,EAAI,IAAIwC,KAAK3D,KAAKX,UAAUR,WAAY4C,EAAI,EAAGA,EAAI,EAAGN,EAAI7B,EAAQ6B,EAAG,GAAIM,IAAK,CACrF,MAAMyB,EAAM,CAAC,UACbvC,EAAQF,KACN0C,EAAA,OAAKC,MAAOF,EAAIG,KAAK,MACnBF,EAAA,OAAKC,MAAM,kBACTD,EAAA,OAAKC,MAAM,OAAOK,EAAOtC,EAAG,W,CAKpC,OAAOR,C,CAGT,wBAAA+C,CAAyB7E,GACvB,MAAM8B,EAAU,GAChB,IAAK,IAAIQ,EAAI,IAAIwC,KAAK9E,GAAY4C,EAAI,EAAGA,EAAI,EAAGN,EAAI7B,EAAQ6B,EAAG,GAAIM,IAAK,CACtE,MAAMyB,EAAM,CAAC,UACb,MAAM9G,EAAO0B,EAAiBjB,EAAWsE,GAAItE,EAAWmD,KAAKgD,cAC7D,GAAI5G,IAAS,EAAG8G,EAAIzC,KAAK,cACpB,GAAIrE,EAAO,EAAG8G,EAAIzC,KAAK,aACvB,GAAIrE,EAAO,EAAG8G,EAAIzC,KAAK,UAC5BE,EAAQF,KACN0C,EAAA,OAAKC,MAAOF,EAAIG,KAAK,MACnBF,EAAA,OAAKC,MAAM,kBACTD,EAAA,OAAKC,MAAM,iBACTD,EAAA,OAAKC,MAAM,OAAOK,EAAOtC,EAAG,S,CAMtC,OAAOR,C,CAGT,WAAAiD,GACE,MAAMC,EAAO,GACb,IAAK,IAAI1C,EAAI,EAAGA,EAAI,GAAIA,IAAK,CAE3B,MAAM+B,EAAM,CAAC,OACb,GAAI/B,EAAI,EAAG+B,EAAIzC,KAAK,QACpB,MAAMqD,EAAYjH,EAAW,IAAI8G,MACjC,MAAMI,EACJZ,EAAA,OAAKC,MAAOF,EAAIG,KAAK,MAClB,MACC,GAAIlC,EAAI,GAAK,GAAKA,EAAG,CACnB,OAAOgC,EAAA,OAAKC,MAAM,QAAQK,EAAOhJ,EAASqJ,EAAW3C,EAAI,GAAI,Q,CAEhE,EAJA,IAOL0C,EAAKpD,KAAKsD,E,CAEZ,OAAOZ,EAAA,OAAKC,MAAM,cAAcS,E,CAGlC,YAAAG,GACE,MAAM2B,EAAe,IAErB,OAAO3F,KAAK0F,cAActB,KAAI,CAACF,EAAU0B,IAErCzC,EAAA,OAAKC,MAAM,qBACTD,EAAA,OAAKC,MAAM,yBACTD,EAAA,OAAKC,MAAM,wBACTD,EAAA,OAAKC,MAAM,WAAWpD,KAAK0D,yBAAyBpE,EAAQU,KAAKX,UAAUR,UAAW+G,EAAQ,MAEhGzC,EAAA,OAAKC,MAAM,gBACTD,EAAA,OAAKC,MAAM,eACRc,EAASE,KAAIC,GAEVlB,EAAA,OAAKC,MAAM,OACRiB,EAAMD,KAAIG,IACT,MAAMrB,EAAM,CAAC,SACb,GAAIlD,KAAKwE,eAAgBtB,EAAIzC,KAAK,aAClC,OACE0C,EAAA,OACEC,MAAOF,EAAIG,KAAK,KAChBC,QAAS,KACP,GAAItD,KAAKwE,eAAgB,CACvBxE,KAAK6F,wBAAwBrC,KAAK,CAAE9D,MAAO6E,EAAKxE,M,GAGpD2E,MAAO,CACLE,KAAM,GAAG5E,KAAK8E,eAAeP,EAAK3E,MAAO,CAAEf,UAAWS,EAAQU,KAAKX,UAAUR,UAAW+G,EAAQ,KAAQD,KACxG1F,MAAO,GACLD,KAAK8E,eAAexF,EAAQiF,EAAK1E,IAAK,GAAI,CAAEhB,UAAWS,EAAQU,KAAKX,UAAUR,UAAW+G,EAAQ,KACjG5F,KAAK8E,eAAeP,EAAK3E,MAAO,CAAEf,UAAWS,EAAQU,KAAKX,UAAUR,UAAW+G,EAAQ,KACvF,EAAID,OAIRxC,EAAA,OAAKC,MAAM,eAAemB,EAAKzE,OAAS,cACpC,OAMhBqD,EAAA,OAAKC,MAAM,oB,CASzB,cAAA0B,CAAe9I,EAAMqD,GACnB,MAAM0F,EAAajH,EAAiBjB,EAAWb,GAAOqD,EAAUR,WAChE,MAAMmG,EAAWD,EAAa,EAAK,IACnC,GAAIC,EAAU,EAAG,OAAO,EACxB,GAAIA,EAAU,IAAK,OAAO,IAC1B,OAAOA,C,CAGT,cAAAjC,CAAe/G,EAAMiJ,GACnB,IAAKA,EAAQA,EAASjJ,EACtB,MAAM6C,EAAYhC,EAAWoI,GAC7B,MAAMnG,EAAUR,EAAS2G,GACzB,MAAMD,GAAYhJ,EAAKkJ,UAAYrG,EAAUqG,YAAcpG,EAAQoG,UAAYrG,EAAUqG,WAAc,IACvG,GAAIF,EAAU,EAAG,OAAO,EACxB,GAAIA,EAAU,IAAK,OAAO,IAC1B,OAAOA,C,CAGT,MAAAI,GACE,OACEjC,EAAA,OAAKC,MAAM,uBACTD,EAAA,OAAKC,MAAM,eACTD,EAAA,OAAKC,MAAM,WAAWpD,KAAKiD,gBAC3BE,EAAA,OAAKC,MAAM,2BAGbD,EAAA,OAAKC,MAAM,aACTD,EAAA,OAAKC,MAAM,oBACTD,EAAA,OAAKC,MAAM,gBAAgBpD,KAAKgE,kB"}